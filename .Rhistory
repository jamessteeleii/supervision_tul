core_assisted == "assisted" ~ "Assisted"
),
levels = c("Core", "Assisted")
))
draws <- bind_rows(
avg_predictions(model_tul,
newdata = datagrid(core_assisted = c("core", "assisted")),
re_formula = NA) |>
get_draws() |>
mutate(distribution = "prior",
draw = draw + 120),
avg_predictions(model_tul,
newdata = datagrid(core_assisted = c("core", "assisted")),
re_formula = NA) |>
get_draws() |>
mutate(distribution = "posterior",
draw = draw + 120)
) |>
mutate(core_assisted = factor(
case_when(
core_assisted == "core" ~ "Core",
core_assisted == "assisted" ~ "Assisted"
),
levels = c("Core", "Assisted")
))
View(draws)
avg_predictions(model_tul)
avg_predictions(model_tul, re_formula = NA)
avg_predictions(model_tul, re_formula = NA, variables = "core_assisted")
avg_predictions(model_tul,  variables = "core_assisted")
model_tul
avg_comparisons(model_tul, re_formula = NA)
avg_comparisons(model_tul)
avg_comparisons(model_tul, re_formula = NA,
variables = "core_assisted")
test_comp <- avg_comparisons(model_tul, re_formula = NA,
variables = "core_assisted") |>
get_draws()
View(test_comp)
targets::tar_visnetwork()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_load(plot_model_tul)
targets::tar_load(plot_preds_tul)
targets::tar_load(plot_contrasts_tul)
plot_preds_tul
plot_contrasts_tul
(plot_preds_tul + plot_contrasts_tul) + plot_layout(guides = "collect")
p_preds <- predictions(model_prior_sample_tul) |> get_draws()
seq(1,10)
seq(0,1)
seq(0,1,0.1)
targets::tar_make()
targets::tar_load(c(plot_preds_rpe, plot_preds_tul_hu, plot_preds_discomfort, plot_contrasts_tul_hu, plot_contrasts_rpe, plot_contrasts_discomfort))
plot_preds_tul_hu
plot_contrasts_tul_hu
plot_preds_rpe
plot_preds_discomfort
plot_contrasts_discomfort
avg_comparisons(model_discomfort)
targets::tar_make()
targets::tar_load(plot_contrasts_discomfort)
plot_contrasts_discomfort
targets::tar_make()
plot_preds_tul + theme(legend.position = element_blank())
plot_preds_tul + guides(fill = "none", color = "none")
(
(
(plot_preds_tul + guides(fill = "none", color = "none")) | plot_contrasts_tul
) /
(
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | plot_contrasts_tul_hu
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
plot_preds_tul_hu
plot_preds_tul
plot_contrasts_tul_hu
plot_contrasts_tul
targets::tar_make()
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu))
(
(
(plot_preds_tul + guides(fill = "none", color = "none")) | plot_contrasts_tul
) /
(
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | plot_contrasts_tul_hu
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
targets::tar_make()
targets::tar_make()
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu))
(
(
(plot_preds_tul + guides(fill = "none", color = "none")) | plot_contrasts_tul
) /
(
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | plot_contrasts_tul_hu
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
targets::tar_make()
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu))
(
(
(plot_preds_tul + guides(fill = "none", color = "none")) | plot_contrasts_tul
) /
(
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | plot_contrasts_tul_hu
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
targets::tar_make()
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu))
(
(
(plot_preds_tul + guides(fill = "none", color = "none")) | plot_contrasts_tul
) /
(
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | plot_contrasts_tul_hu
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
targets::tar_make()
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu))
(
(
(plot_preds_tul + guides(fill = "none", color = "none")) | plot_contrasts_tul
) /
(
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | plot_contrasts_tul_hu
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu,
plot_preds_rpe, plot_preds_discomfort, plot_contrasts_rpe, plot_contrasts_discomfort))
(
(
(plot_preds_rpe + guides(fill = "none", color = "none")) | plot_contrasts_rpe
) /
(
(plot_preds_discomfort) | plot_contrasts_discomfort
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
targets::tar_make()
plot_preds_tul +
theme(panel.grid.minor = element_blank(),
plot.title = element_text(family = "Jost", face = "bold"),
axis.title = element_text(family = "Jost Medium"),
strip.text = element_text(family = "Jost", face = "bold",
size = rel(1), hjust = 0),
strip.background = element_rect(fill = "grey80", color = NA))
plot_preds_tul +
theme_classic()
plot_preds_tul +
theme_bw()
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu,
plot_preds_rpe, plot_preds_discomfort, plot_contrasts_rpe, plot_contrasts_discomfort))
(
(
(plot_preds_rpe + guides(fill = "none", color = "none")) | plot_contrasts_rpe
) /
(
(plot_preds_discomfort) | plot_contrasts_discomfort
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
seq(0,1,0.1)
targets::tar_make()
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu,
plot_preds_rpe, plot_preds_discomfort, plot_contrasts_rpe, plot_contrasts_discomfort))
(
(
(plot_preds_tul + guides(fill = "none", color = "none")) | plot_contrasts_tul
) /
(
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | plot_contrasts_tul_hu
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
(
(
(plot_preds_rpe + guides(fill = "none", color = "none")) | plot_contrasts_rpe
) /
(
(plot_preds_discomfort) | plot_contrasts_discomfort
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
targets::tar_make()
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu,
plot_preds_rpe, plot_preds_discomfort, plot_contrasts_rpe, plot_contrasts_discomfort))
(
(
(plot_preds_tul + guides(fill = "none", color = "none")) | plot_contrasts_tul
) /
(
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | plot_contrasts_tul_hu
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
(
(
(plot_preds_rpe + guides(fill = "none", color = "none")) | plot_contrasts_rpe
) /
(
(plot_preds_discomfort) | plot_contrasts_discomfort
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
targets::tar_make()
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu,
plot_preds_rpe, plot_preds_discomfort, plot_contrasts_rpe, plot_contrasts_discomfort))
(
(
(plot_preds_tul + guides(fill = "none", color = "none")) | plot_contrasts_tul
) /
(
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | plot_contrasts_tul_hu
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
(
(
(plot_preds_rpe + guides(fill = "none", color = "none")) | plot_contrasts_rpe
) /
(
(plot_preds_discomfort) | plot_contrasts_discomfort
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
targets::tar_make()
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu,
plot_preds_rpe, plot_preds_discomfort, plot_contrasts_rpe, plot_contrasts_discomfort))
(
(
(plot_preds_rpe + guides(fill = "none", color = "none")) | plot_contrasts_rpe
) /
(
(plot_preds_discomfort) | plot_contrasts_discomfort
)
) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
targets::tar_load(c(plot_preds_tul, plot_preds_tul_hu, plot_contrasts_tul, plot_contrasts_tul_hu,
plot_preds_rpe, plot_preds_discomfort, plot_contrasts_rpe, plot_contrasts_discomfort,
plot_prior_sample_tul, plot_prior_sample_rpe,
plot_data_tul, plot_data_rpe, plot_data_discomfort))
plot_prior_sample_tul
plot_prior_sample_rpe
plot_data_tul
plot_data_rpe
plot_data_discomfort
tul_plots <- (
(plot_preds_tul + guides(fill = "none", color = "none")) | (plot_contrasts_tul + guides(fill = "none", color = "none"))
)
tul_plots
(
(plot_preds_tul + guides(fill = "none", color = "none")) | (plot_contrasts_tul + guides(fill = "none", color = "none"))
) +
plot_annotation(title = "Time Under Load Predictions and Contrast",
caption = "Raw means [95% quantile intervals] and participant level unpooled predictions") +
tul_plots <- (
(plot_preds_tul + guides(fill = "none", color = "none")) | (plot_contrasts_tul + guides(fill = "none", color = "none"))
) +
plot_annotation(title = "Time Under Load Predictions and Contrast",
caption = "Raw means [95% quantile intervals] and participant level unpooled predictions")
tul_plots <- (
(plot_preds_tul + guides(fill = "none", color = "none")) | (plot_contrasts_tul + guides(fill = "none", color = "none"))
) +
plot_annotation(title = "Time Under Load Predictions and Contrast",
caption = "Raw means [95% quantile intervals] and participant level unpooled predictions")
tul_plots
tul_hu_plots <- (
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | (plot_contrasts_tul_hu + guides(fill = "none", color = "none"))
) +
plot_annotation(title = "Time Under Load Predictions and Contrast")
tul_hu_plots
tul_plots <- (
(plot_preds_tul + guides(fill = "none", color = "none")) | (plot_contrasts_tul + guides(fill = "none", color = "none"))
) +
plot_annotation(title = "Time Under Load",
subtitle = "Global Grand Means for Predictions and Contrasts")
tul_hu_plots <- (
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | (plot_contrasts_tul_hu))
tul_hu_plots <- (
(plot_preds_tul_hu + guides(fill = "none", color = "none")) | (plot_contrasts_tul_hu)
) +
plot_annotation(title = "Stopping at 120 seconds?",
subtitle = "Global Grand Means for Predictions and Contrasts") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
wrap_elements(tul_plots) / wrap_elements(tul_hu_plots)
rpe_plots <- (
(plot_preds_rpe + guides(fill = "none", color = "none")) | (plot_contrasts_rpe)
) +
plot_annotation(title = "Rating of Perceived Effort",
subtitle = "Global Grand Means for Predictions and Contrasts") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
rpe_plots
rpe_plots <- (
(plot_preds_rpe + guides(fill = "none", color = "none")) | (plot_contrasts_rpe)
) +
plot_annotation(title = "Rating of Perceived Effort",
subtitle = "Global Grand Means for Predictions and Contrasts") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
discomfort_plots <- (
(plot_preds_discomfort) | (plot_contrasts_discomfort)
) +
plot_annotation(title = "Time Under Load",
subtitle = "Global Grand Means for Predictions and Contrasts")
wrap_elements(rpe_plots) / wrap_elements(discomfort_plots)
prior_plots <- (
(plot_prior_sample_tul) | (plot_prior_sample_rpe)
) +
plot_annotation(title = "Prior Sample Data Distributions",
subtitle = "Time Under Load and Session Rating of Perceived Effort")
prior_plots
prior_plots <- (
(plot_prior_sample_tul) | (plot_prior_sample_rpe)
) +
plot_annotation(title = "Prior Sample Data Distributions",
subtitle = "Time Under Load and Session Rating of Perceived Effort") +
plot_layout(axes = "collect")
prior_plots
prior_plots <- (
(plot_prior_sample_tul) + theme(strip.text = element_blank()) | (plot_prior_sample_rpe)
) +
plot_annotation(title = "Prior Sample Data Distributions",
subtitle = "Time Under Load and Session Rating of Perceived Effort") +
plot_layout(axes = "collect")
prior_plots
prior_plots <- (
(plot_prior_sample_tul) + theme(strip.text = element_blank()) | (plot_prior_sample_rpe)
) +
plot_annotation(title = "Prior Sample Data Distributions",
subtitle = "Time Under Load and Session Rating of Perceived Effort") +
plot_layout(axes = "collect")
data_plots <- (
(plot_data_tul) | (plot_data_rpe) | (plot_data_discomfort)
) +
plot_annotation(title = "Current Experimental Data Distributions",
subtitle = "Time Under Load, Rating of Perceived Effort, and Rating of Perceived Discomfort")
wrap_elements(prior_plots) / wrap_elements(data_plots)
targets::tar_make()
targets::tar_make()
targets::tar_load(plot_combined_data)
plot_combined_data
targets::tar_make()
targets::tar_load(c(plot_combined_data, plot_combined_tul, plot_combined_rpe_discomfort))
plot_combined_data
targets::tar_make()
targets::tar_load(c(plot_combined_data, plot_combined_tul, plot_combined_rpe_discomfort))
plot_combined_data
plot_combined_tul
plot_combined_rpe_discomfort
renv::status()
?renv::status
renv::install()
renv::snapshot()
renv::status()
targets::tar_load(data)
length(unique(data$location))
length(unique(data$id))
targets::tar_load(model_tul)
targets::tar_load(model_prior_sample_tul)
install.packages("bayestestR")
library(bayestestr)
si(model_tul, BF=1)
library(bayestestR)
si(model_tul, BF=1)
si_tul <- si(model_tul, BF=1)
plot(si_tul)
plot(si_tul)
plot(si_tul) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev)
library(tidyverse)
plot(si_tul) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev)
si_tul <- si(model_tul, BF=3)
si_tul
plot(si_tul) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev)
si_tul <- si(model_tul, BF=10)
plot(si_tul) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev)
si_tul <- si(model_tul, BF=100)
plot(si_tul) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev)
plot(si_tul) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
theme_classic()
si_tul
bayesfactor_parameters(model_tul, null = 0)
plot_si_tul <- plot(si_tul) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
theme_classic()
plot_si_tul[1]
plot_si_tul[[1]]
plot_si_tul[[1]]
si_tul
View(si_tul)
glimpse(si_tul)
si_tul |>
filter(str_detect(Parameter, "hu"))
plogis(si_tul$CI_low[2]) - plogis(si_tul$CI_low[2] + si_tul$CI_low[4])
plogis(si_tul$CI_high[2]) - plogis(si_tul$CI_high[2] + si_tul$CI_high[4])
targets::tar_load(plot_combined_tul)
plot_combined_tul
plogis(si_tul$CI_low[2] + si_tul$CI_low[4]) - plogis(si_tul$CI_low[2])
plogis(si_tul$CI_high[2] + si_tul$CI_high[4]) - plogis(si_tul$CI_high[2])
si_tul <- si(model_tul, BF=1)
plogis(si_tul$CI_low[2] + si_tul$CI_low[4]) - plogis(si_tul$CI_low[2])
plogis(si_tul$CI_high[2] + si_tul$CI_high[4]) - plogis(si_tul$CI_high[2])
set.seed(1988)
si_tul <- si(model_tul, BF=1)
plogis(si_tul$CI_low[2] + si_tul$CI_low[4]) - plogis(si_tul$CI_low[2])
plogis(si_tul$CI_high[2] + si_tul$CI_high[4]) - plogis(si_tul$CI_high[2])
set.seed(1988)
si_tul <- si(model_tul, BF=1)
plogis(si_tul$CI_low[2] + si_tul$CI_low[4]) - plogis(si_tul$CI_low[2])
plogis(si_tul$CI_high[2] + si_tul$CI_high[4]) - plogis(si_tul$CI_high[2])
(plogis(si_tul$CI_low[2] + si_tul$CI_low[4]) - plogis(si_tul$CI_low[2]))*100
(plogis(si_tul$CI_high[2] + si_tul$CI_high[4]) - plogis(si_tul$CI_high[2]))*100
si_tul$CI_low[2]
si_tul
seq(60,180,10)
targets::tar_make()
library(marginaleffects)
draws <- avg_predictions(model_tul, re_formula=NA, variables = "core_assisted") |>
get_draws()
mu <- brms::get_dpar(prep, "mu", i = i)
with(prep$dpars, mu * (1 - hu))
# posterior predict functions
posterior_predict_hurdle_student_t <- function(i, prep, ...) {
nu <- brms::get_dpar(prep, "nu", i = i)
mu <- brms::get_dpar(prep, "mu", i = i)
sigma <- brms::get_dpar(prep, "sigma", i = i)
theta <- brms::get_dpar(prep, "hu", i = i)
hu <- runif(prep$ndraws, 0, 1)
ifelse(hu < theta, 0, brms::rstudent_t(prep$ndraws, nu, mu, sigma))
}
posterior_epred_hurdle_student_t <- function(prep) {
with(prep$dpars, mu * (1 - hu))
}
draws <- avg_predictions(model_tul, re_formula=NA, variables = "core_assisted") |>
get_draws()
prior_draws <- avg_predictions(model_prior_sample_tul, re_formula=NA, variables = "core_assisted") |>
get_draws()
bayesfactor(
draws |> filter(core_assisted == "core") |> select(draw),
prior = prior_draws |> filter(core_assisted == "core") |> select(draw)
)
tidybayes::mean_qi(
draws |> filter(core_assisted == "core") |> select(draw) -
prior = prior_draws |> filter(core_assisted == "core") |> select(draw)
tidybayes::mean_qi(
draws |> filter(core_assisted == "core") |> select(draw) -
prior_draws |> filter(core_assisted == "core") |> select(draw)
)
targets::tar_make()
targets::tar_make()
range(data$tul)
seq(60,600)
seq(60,600,30)
targets::tar_make()
targets::tar_name()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
library(tinytex)
get_priors(model_prior_sample_tul)
brms::get_prior(model_prior_sample_tul)
targets::tar_make()
targets::tar_load(model_tul)
get_priors(model_tul)
brms::get_prior(model_tul)
brms::get_prior(model_tul)
brms::get_prior(model_tul)
brms::get_prior(model_tul)
targets::tar_load(model_rpe)
brms::get_prior(model_rpe)
targets::tar_load(model_prior_sample_rpe)
brms::get_prior(model_prior_sample_rpe)
brms::get_prior(model_rpe)
