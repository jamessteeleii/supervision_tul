side = c("right"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(limits = c(0, 1)) +
labs(
x = "Condition",
y = "Rating of Perceived Effort (%)",
color = "Distribution",
fill = "Distribution"
) +
theme_classic(base_size = 8)
contrast_plot <- contrasts |>
ggplot() +
geom_hline(
yintercept = 0,
linetype = "dashed",
alpha = 0.5,
linewidth = 0.25
) +
stat_slabinterval(
aes(
y = .contrast,
color = distribution,
fill = distribution
),
point_interval = "mean_qi",
.width = .95,
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1,
scale = 0.5
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
# scale_y_continuous(limits = c(0, 200)) +
labs(
x = "Contrast (Assisted minus Core)",
y = "Difference in Rating of Perceived Effort (%)"
) +
guides(color = "none",
fill = "none") +
theme_classic(base_size = 8) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
model_plot + contrast_plot
model_plot <- ggplot() +
stat_slabinterval(
aes(
x = core_assisted,
y = .value,
color = distribution,
fill = distribution
),
data = filter(draws, core_assisted == "Core"),
point_interval = "mean_qi",
.width = .95,
side = c("left"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
stat_slabinterval(
aes(
x = core_assisted,
y = .value,
color = distribution,
fill = distribution
),
data = filter(draws, core_assisted == "Assisted"),
point_interval = "mean_qi",
.width = .95,
side = c("right"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(scale = scales::percent) +
labs(
x = "Condition",
y = "Rating of Perceived Effort (%)",
color = "Distribution",
fill = "Distribution"
) +
theme_classic(base_size = 8)
contrast_plot <- contrasts |>
ggplot() +
geom_hline(
yintercept = 0,
linetype = "dashed",
alpha = 0.5,
linewidth = 0.25
) +
stat_slabinterval(
aes(
y = .contrast,
color = distribution,
fill = distribution
),
point_interval = "mean_qi",
.width = .95,
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1,
scale = 0.5
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(scale = scales::percent) +
labs(
x = "Contrast (Assisted minus Core)",
y = "Difference in Rating of Perceived Effort (%)"
) +
guides(color = "none",
fill = "none") +
theme_classic(base_size = 8) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
model_plot + contrast_plot
model_plot <- ggplot() +
stat_slabinterval(
aes(
x = core_assisted,
y = .value,
color = distribution,
fill = distribution
),
data = filter(draws, core_assisted == "Core"),
point_interval = "mean_qi",
.width = .95,
side = c("left"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
stat_slabinterval(
aes(
x = core_assisted,
y = .value,
color = distribution,
fill = distribution
),
data = filter(draws, core_assisted == "Assisted"),
point_interval = "mean_qi",
.width = .95,
side = c("right"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(labels = scales::percent) +
labs(
x = "Condition",
y = "Rating of Perceived Effort (%)",
color = "Distribution",
fill = "Distribution"
) +
theme_classic(base_size = 8)
contrast_plot <- contrasts |>
ggplot() +
geom_hline(
yintercept = 0,
linetype = "dashed",
alpha = 0.5,
linewidth = 0.25
) +
stat_slabinterval(
aes(
y = .contrast,
color = distribution,
fill = distribution
),
point_interval = "mean_qi",
.width = .95,
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1,
scale = 0.5
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(labels = scales::percent) +
labs(
x = "Contrast (Assisted minus Core)",
y = "Difference in Rating of Perceived Effort (%)"
) +
guides(color = "none",
fill = "none") +
theme_classic(base_size = 8) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
model_plot + contrast_plot
scale_y_continuous(limits = c(0,1, labels = scales::percent) +
x = "Condition",
model_plot <- ggplot() +
stat_slabinterval(
aes(
x = core_assisted,
y = .value,
color = distribution,
fill = distribution
),
data = filter(draws, core_assisted == "Core"),
point_interval = "mean_qi",
.width = .95,
side = c("left"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
stat_slabinterval(
aes(
x = core_assisted,
y = .value,
color = distribution,
fill = distribution
),
data = filter(draws, core_assisted == "Assisted"),
point_interval = "mean_qi",
.width = .95,
side = c("right"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(limits = c(0,1), labels = scales::percent) +
labs(
x = "Condition",
y = "Rating of Perceived Effort (%)",
color = "Distribution",
fill = "Distribution"
) +
theme_classic(base_size = 8)
contrast_plot <- contrasts |>
ggplot() +
geom_hline(
yintercept = 0,
linetype = "dashed",
alpha = 0.5,
linewidth = 0.25
) +
stat_slabinterval(
aes(
y = .contrast,
color = distribution,
fill = distribution
),
point_interval = "mean_qi",
.width = .95,
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1,
scale = 0.5
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(labels = scales::percent) +
labs(
x = "Contrast (Assisted minus Core)",
y = "Difference in Rating of Perceived Effort (%)"
) +
guides(color = "none",
fill = "none") +
theme_classic(base_size = 8) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
model_plot + contrast_plot
draws <- bind_rows(
model_prior_sample_rpe |>
spread_draws(b_Intercept, b_core_assistedcore) |>
mutate(distribution = "prior"),
model_rpe |>
spread_draws(b_Intercept, b_core_assistedcore) |>
mutate(distribution = "posterior")
) |>
mutate(
Assisted = plogis(b_Intercept),
Core = plogis(b_Intercept + b_core_assistedcore)
) |>
select(-b_Intercept, -b_core_assistedcore) |>
pivot_longer(5:6,
names_to = "core_assisted",
values_to = ".value") |>
mutate(core_assisted = factor(
case_when(
core_assisted == "core" ~ "Core",
core_assisted == "assisted" ~ "Assisted"
),
levels = c("Core", "Assisted")
))
contrasts <- bind_rows(
model_prior_sample_rpe |>
spread_draws(b_Intercept, b_core_assistedcore) |>
mutate(distribution = "prior",
.contrast = plogis(b_Intercept) - plogis(b_Intercept + b_core_assistedcore)),
model_rpe |>
spread_draws(b_Intercept, b_core_assistedcore) |>
mutate(distribution = "posterior",
.contrast = plogis(b_Intercept) - plogis(b_Intercept + b_core_assistedcore))
)
model_plot <- ggplot() +
stat_slabinterval(
aes(
x = core_assisted,
y = .value,
color = distribution,
fill = distribution
),
data = filter(draws, core_assisted == "Core"),
point_interval = "mean_qi",
.width = .95,
side = c("left"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
stat_slabinterval(
aes(
x = core_assisted,
y = .value,
color = distribution,
fill = distribution
),
data = filter(draws, core_assisted == "Assisted"),
point_interval = "mean_qi",
.width = .95,
side = c("right"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(limits = c(0,1), labels = scales::percent) +
labs(
x = "Condition",
y = "Rating of Perceived Effort (%)",
color = "Distribution",
fill = "Distribution"
) +
theme_classic(base_size = 8)
contrast_plot <- contrasts |>
ggplot() +
geom_hline(
yintercept = 0,
linetype = "dashed",
alpha = 0.5,
linewidth = 0.25
) +
stat_slabinterval(
aes(
y = .contrast,
color = distribution,
fill = distribution
),
point_interval = "mean_qi",
.width = .95,
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1,
scale = 0.5
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(labels = scales::percent) +
labs(
x = "Contrast (Assisted minus Core)",
y = "Difference in Rating of Perceived Effort (%)"
) +
guides(color = "none",
fill = "none") +
theme_classic(base_size = 8) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
model_plot + contrast_plot
draws
draws <- bind_rows(
model_prior_sample_rpe |>
spread_draws(b_Intercept, b_core_assistedcore) |>
mutate(distribution = "prior"),
model_rpe |>
spread_draws(b_Intercept, b_core_assistedcore) |>
mutate(distribution = "posterior")
) |>
mutate(
Assisted = plogis(b_Intercept),
Core = plogis(b_Intercept + b_core_assistedcore)
) |>
select(-b_Intercept, -b_core_assistedcore) |>
pivot_longer(5:6,
names_to = "core_assisted",
values_to = ".value") |>
mutate(core_assisted = factor(core_assisted,
levels = c("Core", "Assisted")
))
contrasts <- bind_rows(
model_prior_sample_rpe |>
spread_draws(b_Intercept, b_core_assistedcore) |>
mutate(distribution = "prior",
.contrast = plogis(b_Intercept) - plogis(b_Intercept + b_core_assistedcore)),
model_rpe |>
spread_draws(b_Intercept, b_core_assistedcore) |>
mutate(distribution = "posterior",
.contrast = plogis(b_Intercept) - plogis(b_Intercept + b_core_assistedcore))
)
model_plot <- ggplot() +
stat_slabinterval(
aes(
x = core_assisted,
y = .value,
color = distribution,
fill = distribution
),
data = filter(draws, core_assisted == "Core"),
point_interval = "mean_qi",
.width = .95,
side = c("left"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
stat_slabinterval(
aes(
x = core_assisted,
y = .value,
color = distribution,
fill = distribution
),
data = filter(draws, core_assisted == "Assisted"),
point_interval = "mean_qi",
.width = .95,
side = c("right"),
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(limits = c(0,1), labels = scales::percent) +
labs(
x = "Condition",
y = "Rating of Perceived Effort (%)",
color = "Distribution",
fill = "Distribution"
) +
theme_classic(base_size = 8)
contrast_plot <- contrasts |>
ggplot() +
geom_hline(
yintercept = 0,
linetype = "dashed",
alpha = 0.5,
linewidth = 0.25
) +
stat_slabinterval(
aes(
y = .contrast,
color = distribution,
fill = distribution
),
point_interval = "mean_qi",
.width = .95,
slab_alpha = 0.5,
position = position_dodge(w = -0.1),
size = 0.1,
scale = 0.5
) +
scale_color_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_fill_manual(values = c("#56B4E9", "#E69F00"), limits = rev) +
scale_y_continuous(labels = scales::percent) +
labs(
x = "Contrast (Assisted minus Core)",
y = "Difference in Rating of Perceived Effort (%)"
) +
guides(color = "none",
fill = "none") +
theme_classic(base_size = 8) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
model_plot + contrast_plot
(model_plot + contrast_plot) &
theme(legend.position = "bottom")
(model_plot + contrast_plot) +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
(model_plot + contrast_plot) +
plot_layout(guides = "collect",
caption = "Note, rating of perceived effort scaled to (0,1) for ordered beta regression model") &
theme(legend.position = "bottom")
(model_plot + contrast_plot) +
plot_layout(guides = "collect") +
plot_annotation(caption = "Note, rating of perceived effort scaled to (0,1) for ordered beta regression model") &
theme(legend.position = "bottom")
install.packages("data.table")
targets::tar_load(model_rpe)
library(tidyverse)
library(brms)
library(bayesplot)
library(tidybayes)
library(marginaleffects)
library(rstan)
library(patchwork)
avg_comparisons(model_rpe, variables = "core_assisted")
